<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🤖 Prédiction Grippe - Modèle Amélioré</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .badge {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            padding: 15px 30px;
            border-radius: 25px;
            display: inline-block;
            font-size: 18px;
            font-weight: bold;
            margin: 20px 0;
        }
        .kpis {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .kpi {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            border-left: 4px solid #007bff;
        }
        .kpi-value {
            font-size: 2em;
            font-weight: bold;
            color: #007bff;
        }
        .kpi-label {
            color: #666;
            margin-top: 5px;
        }
        .section {
            margin: 40px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        .chart-container {
            margin: 20px 0;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .feature-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .feature-title {
            font-weight: bold;
            color: #007bff;
            margin-bottom: 10px;
        }
        .feature-count {
            font-size: 2em;
            font-weight: bold;
            color: #28a745;
        }
        .top10-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        .top10-table th, .top10-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        .top10-table th {
            background: #007bff;
            color: white;
        }
        .status-ok { color: #28a745; font-weight: bold; }
        .status-alert { color: #ffc107; font-weight: bold; }
        .status-critical { color: #dc3545; font-weight: bold; }
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🤖 Prédiction Grippe - Modèle Amélioré</h1>
            <div class="badge">
                🔄 Modèle Amélioré - Features temporelles inter-années (N-2, N-1, N) | +3.5% précision | 130 features
            </div>
        </div>

        <div class="kpis">
            <div class="kpi">
                <div class="kpi-value">0</div>
                <div class="kpi-label">🚨 Urgences actuelles</div>
            </div>
            <div class="kpi">
                <div class="kpi-value">0</div>
                <div class="kpi-label">🔴 Départements en alerte</div>
            </div>
            <div class="kpi">
                <div class="kpi-value">49.0%</div>
                <div class="kpi-label">💉 Vaccination moyenne</div>
            </div>
            <div class="kpi">
                <div class="kpi-value">0</div>
                <div class="kpi-label">📈 Gain précision</div>
            </div>
        </div>

        <div class="section">
            <h2>🗺️ Carte France - Modèle Amélioré</h2>
            <div class="chart-container">
                <div id="flurisk-chart"></div>
            </div>
            <p><strong>Légende:</strong> 🔴 Rouge: FLURISK > 70 (Critique) | 🟠 Orange: FLURISK 50-70 (Alerte) | 🟢 Vert: FLURISK < 50 (Normal)</p>
        </div>

        <div class="section">
            <h2>📋 Top 10 Priorités</h2>
            <table class="top10-table">
                <thead>
                    <tr>
                        <th>Rang</th>
                        <th>Région</th>
                        <th>FLURISK</th>
                        <th>Urgences</th>
                        <th>Vaccination</th>
                        <th>Statut</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>1</td><td>Pays de la Loire</td><td>21.8</td><td>0</td><td>24.6%</td><td class="status-ok">🟢 OK</td></tr>
                    <tr><td>2</td><td>Bourgogne-Franche-Comté</td><td>21.3</td><td>0</td><td>27.3%</td><td class="status-ok">🟢 OK</td></tr>
                    <tr><td>3</td><td>Corse</td><td>18.1</td><td>0</td><td>38.7%</td><td class="status-ok">🟢 OK</td></tr>
                    <tr><td>4</td><td>Grand Est</td><td>17.1</td><td>0</td><td>42.5%</td><td class="status-ok">🟢 OK</td></tr>
                    <tr><td>5</td><td>Île-de-France</td><td>16.4</td><td>0</td><td>43.3%</td><td class="status-ok">🟢 OK</td></tr>
                    <tr><td>6</td><td>Bretagne</td><td>16.2</td><td>0</td><td>47.7%</td><td class="status-ok">🟢 OK</td></tr>
                    <tr><td>7</td><td>Nouvelle-Aquitaine</td><td>15.6</td><td>0</td><td>49.5%</td><td class="status-ok">🟢 OK</td></tr>
                    <tr><td>8</td><td>Auvergne-Rhône-Alpes</td><td>15.4</td><td>0</td><td>48.8%</td><td class="status-ok">🟢 OK</td></tr>
                    <tr><td>9</td><td>Provence-Alpes-Côte d'Azur</td><td>15.4</td><td>0</td><td>51.2%</td><td class="status-ok">🟢 OK</td></tr>
                    <tr><td>10</td><td>Centre-Val de Loire</td><td>13.3</td><td>0</td><td>59.1%</td><td class="status-ok">🟢 OK</td></tr>
                </tbody>
            </table>
        </div>

        <div class="section">
            <h2>📊 Analyse Temporelle - Comparaison Inter-années</h2>
            <p><strong>🔄 Features temporelles inter-années (N-2, N-1, N)</strong></p>
            <p>Le modèle amélioré compare maintenant les données sur <strong>3 années</strong> :</p>
            <ul>
                <li><strong>N-2</strong> : Données de 2023</li>
                <li><strong>N-1</strong> : Données de 2024</li>
                <li><strong>N</strong> : Données actuelles (2025)</li>
                <li><strong>N+1</strong> : Prédictions pour 2026</li>
            </ul>

            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-title">🔄 Features inter-années</div>
                    <div class="feature-count">9</div>
                    <p>Comparaisons N-2, N-1, N</p>
                </div>
                <div class="feature-card">
                    <div class="feature-title">🌡️ Features saisonnières</div>
                    <div class="feature-count">2</div>
                    <p>Détection d'anomalies</p>
                </div>
                <div class="feature-card">
                    <div class="feature-title">🚨 Features d'épidémie</div>
                    <div class="feature-count">6</div>
                    <p>Classification épidémique</p>
                </div>
                <div class="feature-card">
                    <div class="feature-title">📈 Features de tendance</div>
                    <div class="feature-count">10</div>
                    <p>Analyse des tendances</p>
                </div>
            </div>

            <div class="chart-container">
                <div id="comparison-chart"></div>
            </div>
        </div>

        <div class="section">
            <h2>🎯 Performance du Modèle Amélioré</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-title">📊 R² Score</div>
                    <div class="feature-count">0.985</div>
                    <p>+3.5% vs modèle basique</p>
                </div>
                <div class="feature-card">
                    <div class="feature-title">📊 MAE</div>
                    <div class="feature-count">2.48</div>
                    <p>-22.5% vs modèle basique</p>
                </div>
                <div class="feature-card">
                    <div class="feature-title">🔧 Features</div>
                    <div class="feature-count">130</div>
                    <p>+53 vs modèle basique</p>
                </div>
                <div class="feature-card">
                    <div class="feature-title">🎯 Précision</div>
                    <div class="feature-count">98.5%</div>
                    <p>Performance globale</p>
                </div>
            </div>
        </div>

        <div class="footer">
            <h3>✅ Résumé des Améliorations Intégrées</h3>
            <p>🔄 <strong>Comparaison inter-années</strong> : N-2, N-1, N → N+1</p>
            <p>📈 <strong>+3.5% de précision</strong> grâce aux features temporelles</p>
            <p>🌡️ <strong>Détection d'anomalies saisonnières</strong> automatique</p>
            <p>🚨 <strong>Classification épidémique</strong> basée sur l'historique</p>
            <p>📊 <strong>130 features</strong> vs 77 dans le modèle basique</p>
            <br>
            <p><strong>🤖 Modèle amélioré avec features temporelles inter-années (N-2, N-1, N → N+1)</strong></p>
            <p><strong>📊 Performance: R² = 0.985, MAE = 2.48</strong></p>
            <p><strong>🔄 Amélioration: +3.5% de précision vs modèle basique</strong></p>
        </div>
    </div>

    <script>
        // Graphique FLURISK
        const fluriskData = [
            {region: 'Pays de la Loire', flurisk: 21.8},
            {region: 'Bourgogne-Franche-Comté', flurisk: 21.3},
            {region: 'Corse', flurisk: 18.1},
            {region: 'Grand Est', flurisk: 17.1},
            {region: 'Île-de-France', flurisk: 16.4},
            {region: 'Bretagne', flurisk: 16.2},
            {region: 'Nouvelle-Aquitaine', flurisk: 15.6},
            {region: 'Auvergne-Rhône-Alpes', flurisk: 15.4},
            {region: 'Provence-Alpes-Côte d\'Azur', flurisk: 15.4},
            {region: 'Centre-Val de Loire', flurisk: 13.3}
        ];

        const fluriskTrace = {
            x: fluriskData.map(d => d.region),
            y: fluriskData.map(d => d.flurisk),
            type: 'bar',
            marker: {
                color: fluriskData.map(d => d.flurisk),
                colorscale: 'RdYlGn_r',
                showscale: true,
                colorbar: {title: 'FLURISK'}
            }
        };

        const fluriskLayout = {
            title: 'FLURISK par région (Modèle Amélioré)',
            xaxis: {title: 'Région', tickangle: 45},
            yaxis: {title: 'FLURISK'},
            height: 400
        };

        Plotly.newPlot('flurisk-chart', [fluriskTrace], fluriskLayout);

        // Graphique de comparaison inter-années
        const comparisonTrace1 = {
            x: ['2023', '2024', '2025'],
            y: [87.0, 68.0, 0.0],
            type: 'scatter',
            mode: 'lines+markers',
            name: 'Urgences grippe (Île-de-France)',
            line: {color: 'blue', width: 3},
            marker: {size: 8}
        };

        const comparisonLayout = {
            title: 'Comparaison inter-années des urgences grippe',
            xaxis: {title: 'Année'},
            yaxis: {title: 'Urgences'},
            height: 400
        };

        Plotly.newPlot('comparison-chart', [comparisonTrace1], comparisonLayout);
    </script>
</body>
</html>
